!function(m){"use strict";m.widget("cp.UseyourDrive",{options:{listtoken:null,searchQuery:null},_create:function(){if(this.element.removeClass("jsdisabled"),this.element.show(),this.options.topContainer=this.element.parent(),this.options.loadingContainer=this.element.find(".loading"),this.element.css("width","100%"),this.options.listtoken=this.element.attr("data-token"),this.cache={},this.uploaded_files=[],this.uploaded_files_storage={},this.number_of_uploaded_files={Max:this.element.find('input[name="maxnumberofuploads"]').val(),Counter:0},/Android|webOS|iPhone|iPod|iPad|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var e=navigator.userAgent.toLowerCase();-1<e.search("android")&&-1<e.search("mobile")?this.options.mobile=!0:-1<e.search("android")&&!(-1<e.search("mobile"))?this.options.mobile=!1:this.options.mobile=!0}"1"===this.options.is_mobile&&(this.options.mobile=!0,m("html").addClass("uyd-mobile")),this._initiate()},_destroy:function(){return this._super()},_setOption:function(e,t){this._super(e,t)},_initiate:function(){var i=this;i.options.topContainer.one("inview",function(e,t){i._initResizeHandler(),i._refreshView(),i._initCache(),(i.options.topContainer.hasClass("files")||i.options.topContainer.hasClass("gallery")||i.options.topContainer.hasClass("search"))&&i._initFilebrowser(),0<i.element.find(".fileuploadform").length&&i._initUploadBox(),(i.options.topContainer.hasClass("video")||i.options.topContainer.hasClass("audio"))&&i._initMediaPlayer()}),i.options.topContainer.hasClass("initiate")&&i.options.topContainer.trigger("inview"),window.setTimeout(function(){i.initated=!0},2e3)},_initFilebrowser:function(){this.renderNavMenu(),this._getFileList({})},_initMediaPlayer:function(){},_initUploadBox:function(){var n=this,e=n.options.topContainer.hasClass("upload"),a=n.element.find(".fileuploadform"),t=a.closest("form"),i=!0;if(this._initDragDrop(),!1!==n._helperIsIE()&&m(".upload-multiple-files").parent().remove(),e&&-1==document.cookie.indexOf("UYD-ID=")){var o=new Date;o.setTime(o.getTime()+6048e5);var s="; expires="+o.toUTCString(),r=Math.random().toString(36).substr(2,16);document.cookie="UYD-ID="+r+s+"; path="+n.options.cookie_path+"; domain="+n.options.cookie_domain+";"}0<t.length&&0===t.find("#gravityflow_update_button").length&&(i=!1,t.find('input[type="submit"], input[type="button"].gform_next_button, button[id^="gform_submit_button"]').on("click",function(e){return void 0===m(this).data("old-value")&&m(this).data("old-value",m(this).val()),a.closest(".gfield_contains_required").length&&0===n.number_of_uploaded_files.Counter?(a.css("border-color","red"),e.preventDefault(),e.stopPropagation(),!1):(m(this).addClass("firing").prop("disabled",!0).fadeTo(400,.3),a.css("border-color",""),0<t.find(".template-upload").length?(m("html, body").stop().animate({scrollTop:n.element.offset().top-150},1e3),a.trigger("useyourdrive-startupload"),m(this).val(n.options.str_processing),e.preventDefault(),e.stopPropagation(),!1):(m(this).addClass("firing").prop("disabled",!1).fadeTo(400,1),m(this).val(m(this).data("old-value")),t.hasClass("wpcf7-form")||t.trigger("submit",[!0]),!0))}));0<t.length&&0<t.find(".fileupload-filelist").val().length&&(n.uploaded_files_storage=JSON.parse(n.element.find(".fileupload-filelist").val()),m.each(n.uploaded_files_storage,function(e,t){n._uploadRenderRow(t),n._uploadRenderRowOnFinish(t),n.number_of_uploaded_files.Counter++})),n.element.find(".fileupload-list").click(function(){n.element.find(".upload-input-button:first").trigger("click")});var l="1"===n.element.find('input[name="encryption"]').val(),d=m.support.xhrFileUpload&&!l,u=d&&!new RegExp("(Opera Mobi)|(Android)").test(window.navigator.userAgent),c=!d,p=d?"PUT":"POST",f=u?5242880:0;d&&"0"===n.element.find('input[name="maxfilesize"]').attr("data-limit")&&(n.element.find('input[name="maxfilesize"]').val(""),n.element.find(".fileupload-container").find(".max-file-size").text(n.options.str_uploading_no_limit)),a.fileupload({url:n.options.ajax_url,type:p,maxChunkSize:f,singleFileUploads:!0,multipart:c,dataType:"json",autoUpload:i,maxFileSize:d&&"0"===n.element.find('input[name="maxfilesize"]').attr("data-limit")?"undefined":n.options.post_max_size,acceptFileTypes:new RegExp(n.element.find('input[name="acceptfiletypes"]').val(),"i"),dropZone:n.element,messages:{maxNumberOfFiles:n.options.maxNumberOfFiles,acceptFileTypes:n.options.acceptFileTypes,maxFileSize:n.options.maxFileSize,minFileSize:n.options.minFileSize},limitConcurrentUploads:3,disableImageLoad:!0,disableImageResize:!0,disableImagePreview:!0,disableAudioPreview:!0,disableVideoPreview:!0,uploadTemplateId:null,downloadTemplateId:null,add:function(e,o){m.each(o.files,function(t,i){n.number_of_uploaded_files.Counter++,i.hash=i.name.hashCode()+"_"+Math.floor(1e6*Math.random()),i.listtoken=n.options.listtoken,i=n._uploadValidateFile(i);var e=n._uploadRenderRow(i);!1!==i.error&&(n.number_of_uploaded_files.Counter--,a.trigger("useyourdrive-removeupload",[o.files[t]]),o.files.splice(t,1)),e.find(".cancel-upload").on("click",function(e){e.preventDefault(),e.stopPropagation(),o.files.splice(t,1),n.number_of_uploaded_files.Counter--,n._uploadDeleteRow(i,0),a.trigger("useyourdrive-removeupload",[o.files[t]])})}),a.trigger("useyourdrive-addupload",[o]),o.autoUpload||!1!==o.autoUpload&&m(this).fileupload("option","autoUpload")?0<o.files.length&&o.process().done(function(){n._uploadDoRequest(o)}):m(this).on("useyourdrive-startupload",function(){0<o.files.length&&o.process().done(function(){n._uploadDoRequest(o)})})},submit:function(e,t){var i;if(window.onbeforeunload=function(){return!0},m.each(t.files,function(e,t){i=t,n._uploadRenderRowOnStart(i),i.hash}),d){var o=m(this);return m.ajax({type:"POST",url:UseyourDrive_vars.ajax_url,data:{action:"useyourdrive-upload-file",type:"get-direct-url",filename:i.name,file_size:i.size,mimetype:i.type,orgin:window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),lastFolder:n.element.attr("data-id"),listtoken:n.options.listtoken,_ajax_nonce:n.options.upload_nonce},error:function(){i.error=n.options.str_error,n._uploadRenderRowOnFinish(i)},success:function(e){void 0===e.result||void 0===e.url?(i.error=n.options.str_error,n._uploadRenderRowOnFinish(i)):(t.url=e.url,i.convert=e.convert,t.jqXHR=o.fileupload("send",t))},dataType:"json"}),!1}t.formData={action:"useyourdrive-upload-file",type:"do-upload",hash:i.hash,lastFolder:n.element.attr("data-id"),listtoken:n.options.listtoken,_ajax_nonce:n.options.upload_nonce}}}).on("fileuploadsubmit",function(e,t){}).on("fileuploadprogress",function(e,t){var i=t.files[0];if(d){var o=parseInt(t.loaded/t.total*100,10);n._uploadRenderRowOnProgress(i,{percentage:o,progress:"uploading_to_cloud"})}else{o=parseInt(t.loaded/t.total*100,10)/2;n._uploadRenderRowOnProgress(i,{percentage:o,progress:"uploading_to_server"}),50<=o&&(n._uploadRenderRowOnProgress(i,{percentage:50,progress:"uploading_to_cloud"}),setTimeout(function(){n._uploadGetProgress(i)},2e3))}}).on("fileuploadstopped",function(){m(".gform_button:submit").prop("disabled",!1).fadeTo(400,1),m(".wpcf7-submit").prop("disabled",!1).fadeTo(400,1)}).on("fileuploaddone",function(e,t){sendDriveGooglePageView("Upload file")}).on("fileuploadalways",function(e,t){var i=t.files[0];null===t.result&&(i.error=n.options.str_error,n._uploadRenderRowOnFinish(i)),d?(i.fileid=t.result.id,i.completepath="",i.filesize=n._helperFormatBytes(t.result.size,1),i.link=t.result.webViewLink,i.convert?n._uploadDoConvert(i):n._uploadRenderRowOnFinish(i)):void 0!==t.result?void 0!==t.result.status?"finished"!==t.result.status.progress&&"failed"!==t.result.status.progress||n._uploadRenderRowOnFinish(t.result.file):(t.result.file.error=n.options.str_error,n._uploadRenderRowOnFinish(t.result.file)):(i.error=n.options.str_error,n._uploadRenderRowOnFinish(i))}).on("fileuploaddrop",function(e,t){var i=m(this);m("html, body").animate({scrollTop:i.offset().top},1500)}).on("useyourdrive-upload-finished",function(e){t.find('input[type="submit"].firing, input[type="button"].gform_next_button.firing, button[id^="gform_submit_button"]').prop("disabled",!1).trigger("click"),m('input[type="submit"]').prop("disabled",!1).fadeTo(400,1)})},_getFileList:function(e){var t=this._buildFileListRequest();this.element.find(".no_results").remove(),this.options.loadingContainer.removeClass("initialize upload error").fadeIn(400),this.element.find(".nav-refresh i").addClass("fa-spin"),t(e,this.renderBrowserContent,this)},_buildFileListRequest:function(e){var t=this;return this._pipeline({url:t.options.ajax_url,type:"POST",dataType:"json",data:function(e){return e.listtoken=t.options.listtoken,e.lastFolder=t.element.attr("data-id"),e.folderPath=t.element.attr("data-path"),e.sort=t.element.attr("data-sort"),e.deeplink=t.element.attr("data-deeplink"),e.filelayout=t.element.attr("data-layout"),e.action="useyourdrive-get-filelist",e._ajax_nonce=t.options.refresh_nonce,e.mobile=t.options.mobile,"gallery"===t.element.attr("data-list")&&(e.action="useyourdrive-get-gallery",e._ajax_nonce=t.options.gallery_nonce),e.query=t.searchQuery,e}})},_initSearchBox:function(){var t=this,e=this.element.find(".nav-search");e.qtip({prerender:!1,id:"search-"+t.options.listtoken,content:{text:e.next(".search-div"),button:e.next(".search-div").find(".search-remove")},position:{my:"top right",at:"bottom center",target:e,viewport:m(window),adjust:{scroll:!1}},style:{classes:"UseyourDrive search "+t.options.content_skin},show:{effect:function(){m(this).fadeTo(90,1,function(){m("input",this).focus()})}},hide:{fixed:!0,delay:1500}}),t.element.find(".search-input").on("keyup",function(e){t.searchQuery=m(this).val(),0<m(this).val().length?(t.options.loadingContainer.addClass("search"),t.element.find(".nav-search").addClass("inuse"),clearTimeout(t.updateTimer),t.updateTimer=setTimeout(function(){t.element.find(".loading, .ajax-filelist").show(),t._getFileList({})},1e3)):(t.element.find(".nav-search").removeClass("inuse"),t.element.hasClass("searchlist")&&(t.element.find(".loading, .ajax-filelist").hide(),t.element.find(".ajax-filelist").html("")))}),t.element.find(".submit-search").click(function(){t.searchQuery=m(this).val(),0<m(this).val().length?(clearTimeout(t.updateTimer),t.updateTimer=setTimeout(function(){t.element.find(".loading, .ajax-filelist").show(),t._getFileList({})},1e3)):(t.element.find(".loading, .ajax-filelist").hide(),t.element.find(".ajax-filelist").html(""))}),t.element.find(".search-remove").click(function(){""!==m(this).parent().find(".search-input").val()&&t.clearSearchBox()})},clearSearchBox:function(){m('[data-qtip-id="search-'+this.options.listtoken+'"] .search-input').val("").trigger("keyup")},_initGearMenu:function(){var n=this,e=this.element.find(".nav-gear");e.qtip({prerender:!1,id:"nav-"+n.options.listtoken,content:{text:e.next(".gear-menu")},position:{my:"top right",at:"bottom center",target:e,viewport:m(window),adjust:{scroll:!1}},style:{classes:"UseyourDrive "+n.options.content_skin},show:{event:"click, mouseenter",solo:!0},hide:{event:"mouseleave unfocus",fixed:!0,delay:200},events:{show:function(e,t){0===n._helperReadArrCheckBoxes("[data-token='"+n.options.listtoken+"'] input[name='selected-files[]']").length?(t.elements.content.find(".selected-files-to-zip").parent().hide(),t.elements.content.find(".all-files-to-zip").parent().show(),t.elements.content.find(".selected-files-delete").parent().hide()):(t.elements.content.find(".selected-files-to-zip").parent().show(),t.elements.content.find(".all-files-to-zip").parent().hide(),t.elements.content.find(".selected-files-delete").parent().show()),0<t.elements.content.find("ul > li").not(".gear-menu-no-options").filter(function(){return"none"!==m(this).css("display")}).length?t.elements.content.find(".gear-menu-no-options").hide():t.elements.content.find(".gear-menu-no-options").show()}}}),this.element.find(".nav-layout").unbind("click").click(function(){"list"===n.element.attr("data-layout")?n.element.attr("data-layout","grid"):n.element.attr("data-layout","list"),n._getFileList({})}),this.element.find(".select-all-files").unbind("click").click(function(){n.element.find(".selected-files:checkbox").prop("checked",m(this).prop("checked")),!0===m(this).prop("checked")?n.element.find('.entry:not(".newfolder")').addClass("isselected"):n.element.find('.entry:not(".newfolder")').removeClass("isselected")}),this.element.find(".all-files-to-zip, .selected-files-to-zip").unbind("click").click(function(e){var t=[];m(e.target).hasClass("all-files-to-zip")&&(n.element.find(".select-all-files").trigger("click"),t=n._helperReadArrCheckBoxes("[data-token='"+n.options.listtoken+"'] input[name='selected-files[]']")),m(e.target).hasClass("selected-files-to-zip")&&(t=n._helperReadArrCheckBoxes("[data-token='"+n.options.listtoken+"'] input[name='selected-files[]']"));var i={action:"useyourdrive-create-zip",listtoken:n.options.listtoken,lastFolder:n.element.attr("data-id"),_ajax_nonce:n.options.createzip_nonce,files:t},o=m('<div class="processor_icon"><i class="fas fa-cog fa-spin fa-1x fa-fw"></i></div>').css({"margin-right":"5px",display:"inline-grid"});n.element.find(".layout-grid input:checked[name='selected-files[]']").closest(".entry").find(".entry-name-view").prepend(o),n.element.find(".layout-list input:checked[name='selected-files[]']").closest(".entry").find(".entry_name").prepend(o),n.element.find(".processor_icon").delay(5e3).fadeOut("slow",function(){m(this).remove()}),m(e.target).hasClass("all-files-to-zip")&&n.element.find(".select-all-files").trigger("click"),m(".qtip").qtip("hide"),m(this).attr("href",n.options.ajax_url+"?"+m.param(i))}),n.element.find(".nav-upload").click(function(){m(".qtip").qtip("hide");var e=n.element.find(".fileupload-container");m("html, body").animate({scrollTop:e.offset().top},1500);for(var t=0;t<3;t++)e.find(".fileupload-buttonbar").fadeTo("slow",.5).fadeTo("slow",1)}),n.element.find(".selected-files-delete").click(function(){m(".qtip").qtip("hide");var e=n.element.find("input[name='selected-files[]']:checked");if(0===e.length)return!1;n._actionDeleteEntries(e)}),n.element.find(".entry_action_shortlink_folder").unbind("click").click(function(e){n._actionShareEntry(m(this))})},renderBrowserContent:function(i,e){!1===e?(i.element.find(".nav-title").html(i.options.str_no_filelist),i.options.loadingContainer.addClass("error")):(i.options.loadingContainer.fadeIn(200),i.element.find(".ajax-filelist").html(e.html),i.element.find(".image-collage").hide(),i.element.find(".nav-title").html(e.breadcrumb),i.element.find(".current-folder-raw").text(e.rawpath),null!==e.lastFolder&&i.element.attr("data-id",e.lastFolder),null!==e.folderPath&&i.element.attr("data-path",e.folderPath)),i.element.find(".nav-refresh i").removeClass("fa-spin"),i.unveilImages(),i.element.hasClass("gridgallery")?(i.renderContentForGallery(),i._initLazyLoading()):i.renderContentForBrowser(),i.unveilImages(),i.element.find(".entry").unbind("hover").hover(function(){m(this).addClass("hasfocus")},function(){m(this).removeClass("hasfocus")}).on("mouseover",function(){m(this).addClass("hasfocus")}).unbind("click").click(function(){}).on("contextmenu",function(e){return!1}),i.element.find(".folder, .image-folder").unbind("click").click(function(e){if(m(this).hasClass("isdragged")||m(this).hasClass("newfolder"))return!1;e.stopPropagation(),i.clearSearchBox();var t={id:m(this).closest(".folder, .image-folder").attr("data-id")};i._getFileList(t),m("html, body").stop().animate({scrollTop:i.element.offset().top-150},1e3)}),i.element.find(".newfolder").unbind("click").click(function(e){i._actionCreateEntry(m(this))}),i.element.find(".entry_checkbox").unbind("click").click(function(e){return e.stopPropagation(),!0}),i.element.find(".entry_checkbox :checkbox").click(function(e){m(this).prop("checked")?m(this).closest(".entry").addClass("isselected"):m(this).closest(".entry").removeClass("isselected")}),i._initEditMenu(),i._initDescriptionBox(),i._initLightbox(),i.renderThumbnailsPopup(),i._initMove(),i._initLinkEvent(),i._initScrollToTop(),i.options.loadingContainer.fadeOut(300)},renderContentForBrowser:function(){var e=this;switch(this.element.attr("data-layout")){case"list":e.element.removeClass("uyd-grid").addClass("uyd-list"),m(".qtip[data-qtip-id='nav-"+e.options.listtoken+"']").find(".fa-th-large").closest("li").show(),e.element.find(".fa-th-large").closest("li").show(),m(".qtip[data-qtip-id='nav-"+e.options.listtoken+"']").find(".fa-th-list").closest("li").hide(),e.element.find(".fa-th-list").closest("li").hide();break;case"grid":e.element.removeClass("uyd-list").addClass("uyd-grid"),m(".qtip[data-qtip-id='nav-"+e.options.listtoken+"']").find(".fa-th-large").closest("li").hide(),e.element.find(".fa-th-large").closest("li").hide(),m(".qtip[data-qtip-id='nav-"+e.options.listtoken+"']").find(".fa-th-list").closest("li").show(),e.element.find(".fa-th-list").closest("li").show();var t=e.element.find(".files.layout-grid"),i=t.innerWidth()-1,o=Math.ceil(i/175),n=Math.floor(i/o);t.removeWhitespace(),e.element.find(".entry_block").each(function(){var e=parseInt(m(this).css("padding-left"))+parseInt(m(this).css("padding-right"));m(this).parent().outerWidth(n-e,!0)}),t.fadeTo(0,0).delay(100).fadeTo(200,1)}},renderContentForGallery:function(){var e=this,t=e.element.find(".image-container"),i=e.element.find(".image-collage");t.hover(function(){m(this).find(".image-rollover").stop().animate({opacity:1},400)},function(){m(this).find(".image-rollover").stop().animate({opacity:0},400)}).find(".image-rollover").css("opacity","0"),i.outerWidth(e.element.find(".ajax-filelist").width()-1,!0);var o=e.element.attr("data-targetheight");i.removeWhitespace().collagePlus({targetHeight:o,fadeSpeed:"slow",allowPartialLastRow:!0}),e.element.find(".image-container.hidden").fadeOut(0),i.fadeTo(200,1),t.each(function(){var e=m(this).find(".folder-thumb");m(this).find(".image-folder-img").width(m(this).width()).height(m(this).height()),0<e.length&&(e.width(m(this).width()).height(m(this).height()),m(this).find(".image-folder-img").hide())}),0<e.element.find(".loadthumbs").length&&e.loadImageFoldersThumbs(),e.renderImageFolders()},loadImageFoldersThumbs:function(){var o=this,e=o.element.find(".loadthumbs").removeClass("loadthumbs").map(function(){return m(this).data("id")}).get();m.ajax({type:"POST",url:o.options.ajax_url,data:{action:"useyourdrive-thumbnail",type:"folder-thumbnails",listtoken:o.options.listtoken,lastFolder:o.element.attr("data-id"),folderPath:o.element.attr("data-path"),folders:e},success:function(e){m.each(e,function(e,t){if(""===t)return!0;var i=o.element.find('[data-id="'+e+'"]');i.find(".folder-thumb").remove(),i.find(".image-folder-img").hide().after(t),i.find(".folder-thumb").width(m(i).width()).height(m(i).height()).first().fadeIn(1500)})},dataType:"json"})},renderImageFolders:function(){this.element.find(".image-folder").unbind("mousemove").mousemove(function(e){var t=m(this).find(".folder-thumb"),i=e.offsetX/e.currentTarget.offsetWidth,o=Math.ceil(i*t.length)-1;t.filter(":gt(0)").stop(!0).fadeOut().filter(":eq("+o+")").stop(!0).fadeIn()}),this.element.find(".image-folder").unbind("mouseleave").mouseleave(function(){m(this).find(".folder-thumb:gt(0)").stop(!0).fadeOut()})},_initLazyLoading:function(){var o=this,e=o.element.find(".image-container.entry:not(.hidden):last()"),n=o.element.attr("data-loadimages");e.one("inview",function(e,t){var i=o.element.find(".image-container:hidden:lt("+n+")");0!==i.length&&(i.fadeIn(500).removeClass("hidden").find("img").removeClass("hidden"),o.unveilImages(),o._initLazyLoading())})},_initScrollToTop:function(){var e=this;0!==e.element.find(".ajax-filelist").length&&(e.element.find(".scroll-to-top").unbind("click").click(function(){m("html, body").animate({scrollTop:e.element.offset().top},1500)}),m(window).off("scroll",null,e._positionScrollToTop).on("scroll",null,{},e._positionScrollToTop))},_positionScrollToTop:function(e){clearTimeout(window.scrollTimer),window.scrollTimer=setTimeout(function(){m(".ajax-filelist").each(function(){var e=m(this),t=e.next(".scroll-to-top"),i=e.height(),o=e.offset(),n=o.top+i,a=m(window).scrollTop(),s=a+m(window).height();if(a>o.top&&i>m(window).height()){t.show().fadeIn(40);var r=i;s<n&&(r=s-o.top-30),t.stop().animate({top:Math.round(r-50)})}else t.fadeOut(400)})},50)},_initMove:function(){var i=this;if(0===this.element.find(".moveable").length)return!1;this.element.find(".moveable").draggable({stack:".moveable",cursor:"move",cursorAt:{top:10,left:10},containment:"parent",helper:"clone",distance:10,delay:50,start:function(e,t){m(this).addClass("isdragged")},stop:function(e,t){setTimeout(function(){m(this).removeClass("isdragged")},300)}}),this.element.find(".folder").droppable({accept:i.element.find(".moveable"),activeClass:"ui-state-hover",hoverClass:"ui-state-active",tolerance:"pointer",drop:function(e,t){i._actionMoveEntry(t.draggable,m(this))}})},_initLinkEvent:function(){var a=this;a.element.find(".entry_linkto").unbind("click").click(function(e){var t=m(this).parent().attr("data-name"),i=m(this).parent().attr("data-id"),o=m(".useyourdrive .thickbox_opener").find("[data-user-id]").attr("data-user-id"),n=m(".thickbox_opener");return n.hasClass("private-folders-auto")?(n.find(".private-folders-auto-current").val(t),n.find(".private-folders-auto-input-id").val(i),n.find(".private-folders-auto-input-name").val(t),n.find(".private-folders-auto-button").removeClass("disabled").find(".uyd-spinner").fadeOut(),tb_remove()):n.hasClass("woocommerce_upload_location")?(m("#woocommerce_useyourdrive-woocommerce_upload_location_id").val(i),m("#woocommerce_useyourdrive-woocommerce_upload_location").val(t),tb_remove()):m.ajax({type:"POST",url:a.options.ajax_url,data:{action:"useyourdrive-linkusertofolder",id:i,text:t,userid:o,_ajax_nonce:a.options.createlink_nonce},beforeSend:function(){tb_remove(),m(".useyourdrive .thickbox_opener").find(".uyd-spinner").show()},complete:function(){m(".uyd-spinner").hide()},success:function(e){"1"===e?(m(".useyourdrive .thickbox_opener").parent().find(".column-private_folder").text(t),m(".useyourdrive .thickbox_opener .unlinkbutton").removeClass("hidden"),m(".useyourdrive .thickbox_opener .linkbutton").addClass("hidden"),m(".useyourdrive .thickbox_opener").removeClass("thickbox_opener")):location.reload(!0)},dataType:"text"}),e.stopPropagation(),!0}),a.element.find(".entry_woocommerce_link").unbind("click").click(function(e){var t=m(this).closest(".entry").attr("data-id"),i=m(this).closest(".entry").attr("data-name");return tb_remove(),window.wc_useyourdrive.afterFileSelected(t,i),e.stopPropagation(),!0})},_initEditMenu:function(){var o=this;o.element.find(" .entry .entry_edit_menu").each(function(){m(this).click(function(e){e.stopPropagation()}),m(this).qtip({content:{text:m(this).next(".uyd-dropdown-menu")},position:{my:"top center",at:"bottom center",target:m(this),scroll:!1,viewport:o.element},show:{event:"click",solo:!0},hide:{event:"mouseleave unfocus",delay:200,fixed:!0},events:{show:function(e,t){t.elements.target.closest(".entry").addClass("hasfocus").addClass("popupopen")},hide:function(e,t){t.elements.target.closest(".entry").removeClass("hasfocus").removeClass("popupopen")}},style:{classes:"UseyourDrive "+o.options.content_skin}})}),o.element.find(".entry_action_view").unbind("click").click(function(){o._actionPreviewEntry(m(this))}),o.element.find(".entry_action_download").unbind("click").click(function(e){o._actionDownloadEntry(m(this))}),o.element.find(".entry_action_export").unbind("click").click(function(e){o._actionExportEntry(e,m(this))}),o.element.find(".entry_action_shortlink").unbind("click").click(function(e){o._actionShareEntry(m(this))}),o.element.find(".entry_action_delete").unbind("click").click(function(e){var t=m(this).closest("ul").attr("data-id"),i=o.element.find(".entry[data-id='"+t+"'] .selected-files:checkbox");o._actionDeleteEntries([i])}),o.element.find(".entry_action_rename").unbind("click").click(function(e){o._actionRenameEntry(m(this))}),o.element.find(".entry_action_description").unbind("click").click(function(e){o._actionEditDescriptionEntry(e,m(this))})},_initDescriptionBox:function(){var e=this;e.element.find(".entry .entry_description").each(function(){m(this).click(function(e){e.stopPropagation()}),m(this).qtip({content:{text:m(this).next(".description_textbox")},position:{my:"top center",at:"bottom center",target:m(this),scroll:!1,viewport:e.element},show:{delay:200,solo:!0},hide:{event:"mouseleave unfocus",delay:200,fixed:!0},events:{show:function(e,t){t.elements.target.closest(".entry").addClass("hasfocus").addClass("popupopen")},hide:function(e,t){if(0<t.elements.content.find(".description_textarea").length){var i=t.elements.content.find(".description_textarea").val().replace(/\r\n|\r|\n/g,"<br />"),o=m("<div>").addClass("description_text");o.html(i),t.elements.content.find(".description_textarea").replaceWith(o),t.elements.content.find("input[type=button]").remove(),t.elements.content.find(".ajaxprocess").remove(),t.elements.content.find(".entry_action_description").show()}t.elements.target.closest(".entry").removeClass("hasfocus").removeClass("popupopen")}},style:{classes:"UseyourDrive description "+e.options.content_skin}})})},renderThumbnailsPopup:function(){var e=this;e.element.find(".entry[data-tooltip] .entry_name, .entry[data-tooltip] .entry_lastedit").each(function(){m(this).qtip({suppress:!0,content:{text:function(e,t){var i=m(this).parent().find(".description_textbox").clone();return i.find("img.preloading").removeClass("hidden").unveil(200,null,function(){m(this).load(function(){m(this).removeClass("preloading").removeAttr("data-src"),m(this).prev(".preloading").remove()})}),i}},position:{target:"mouse",adjust:{x:5,y:5,scroll:!1},viewport:e.element},show:{delay:500,solo:!0},hide:{event:"click mouseleave unfocus"},style:{classes:"UseyourDrive description "+e.options.content_skin}})})},unveilImages:function(){this.element.find("img.preloading").one("error",function(){this.src=m(this).attr("data-src-backup"),m(this).removeAttr("data-src"),m(this).prev(".preloading").remove()}),this.element.find("img.preloading").not(".hidden").unveil(200,null,function(){m(this).load(function(){m(this).removeClass("preloading").removeAttr("data-src"),m(this).prev(".preloading").remove()})}),setTimeout(function(){},200)},renderNavMenu:function(){var i=this;this._initSearchBox(),this._initGearMenu(),this.element.find(".nav-refresh").unbind("click"),this.element.find(".nav-refresh").click(function(){i.clearSearchBox(),i.options.forceRefresh=!0,i._getFileList({})}),this.element.find(".nav-home").unbind("click"),this.element.find(".nav-home").click(function(){i.clearSearchBox(),i.element.attr("data-id",i.element.attr("data-org-id")).attr("data-path",""),i._getFileList({lastFolder:i.element.attr("data-org-id")})}),i.element.find(".sortable").click(function(){var e="asc";m(this).hasClass("asc")&&(e="desc"),i.element.find(".sortable").removeClass("asc").removeClass("desc"),m(this).addClass(e);var t=m(this).attr("data-sortname")+":"+e;i.element.attr("data-sort",t),i._getFileList({})})},_initLightbox:function(){var a=this;m.isEmptyObject(this.lightBox)||this.lightBox.destroy(),this.lightBox=a.element.find(".ilightbox-group").iLightBox({skin:this.options.lightbox_skin,path:this.options.lightbox_path,maxScale:1,slideshow:{pauseOnHover:!0,pauseTime:a.element.attr("data-pausetime"),startPaused:"gallery"!==a.element.attr("data-list")||"1"!==a.element.attr("data-slideshow")},controls:{slideshow:"gallery"===a.element.attr("data-list"),arrows:!0,thumbnail:!a.options.mobile},caption:{start:"mouseenter"===a.options.lightbox_showcaption,show:a.options.lightbox_showcaption,hide:"mouseenter"===a.options.lightbox_showcaption?"mouseleave":a.options.lightbox_showcaption},keepAspectRatio:!0,callback:{onBeforeLoad:function(e,t){m(".ilightbox-holder").addClass("UseyourDrive"),m(".ilightbox-holder .uyd-hidepopout").remove();var i=m(".ilightbox-holder").find("iframe").addClass("uyd-embedded");"0"===a.element.attr("data-popout")&&m(".ilightbox-holder").find(".uyd-embedded").after('<div class="uyd-hidepopout">&nbsp;</div>'),a._helperIframeFix(i)},onBeforeChange:function(){var e=m(".ilightbox-holder video, .ilightbox-holder audio");m.each(e,function(e,t){!1===t.paused&&t.pause()})},onAfterChange:function(e){var t=e.currentElement.find("video, audio");m.each(t,function(e,t){t.paused&&t.play()})},onRender:function(o,e){var t=m(".ilightbox-holder").find("video, audio");m.each(t,function(e,t){var i=m(this);t.addEventListener("playing",function(){var e=o.currentElement.find(".ilightbox-container").width()-1,t=o.currentElement.find(".ilightbox-container").height()-1;i.width(e),i.parent().width(e),i.height()>o.currentElement.find(".ilightbox-container").height()-2&&i.height(t)},!1),i.find("source").attr("src",i.find("source").attr("data-src"))})},onShow:function(e){0===e.currentElement.find(".empty_iframe").length&&e.currentElement.find(".uyd-embedded").after(a.options.str_iframe_loggedin),0<e.currentElement.find("iframe").length&&(setTimeout(function(){e.currentElement.find(".uyd-embedded").width(e.currentElement.find(".ilightbox-container").width()-1)},500),e.currentElement.find("iframe").on("load",function(){e.currentElement.find(".empty_iframe").remove()})),e.currentElement.find(".empty_iframe").hide(),0===e.currentElement.find("img").length&&setTimeout(function(){e.currentElement.find(".empty_iframe").fadeIn(),e.currentElement.find(".empty_iframe_link").attr("href",e.currentElement.find("iframe").attr("src"))},5e3);var t=e.currentElement.find("video, audio");m.each(t,function(e,t){t.paused&&t.play()});var i=this;m(".ilightbox-thumbnail img.preloading").unveil(null,null,function(){m(this).load(function(){m(this).removeClass("preloading").removeAttr("data-src"),m(this).prev(".preloading").remove(),m(this).parent().data({naturalWidth:this.width,naturalHeight:this.height}),i.positionThumbnails(null,null,null)})}),m(".ilightbox-container .uyd-hidepopout").on("contextmenu",function(e){return!1}),m(".ilightbox-container img").on("contextmenu",function(e){return"Yes"===a.options.lightbox_rightclick}),a.options.mobile&&(m(".ilightbox-container img").panzoom({disablePan:!0,minScale:1,contain:"invert"}),m(".ilightbox-container img").on("panzoomzoom",function(e,t,i){t.options.disablePan=1==i}));var o=e.currentElement.find("img");if(0<o.length&&1!==o.data("logged")&&-1===o.attr("src").indexOf("action=useyourdrive-")){var n=m('a[href="'+o.attr("src")+'"]').closest("[data-id]").data("id");o.data("logged",1),a._logEvent("log_preview_event",n)}}},errors:{loadImage:a.options.str_imgError_title,loadContents:a.options.str_xhrError_title},text:{next:a.options.str_next_title,previous:a.options.str_previous_title,slideShow:a.options.str_startslideshow}})},createUrlDeepLink:function(e){var t={shortcode_id:this.options.listtoken,request:null},i=Base64.encode(encodeURIComponent(JSON.stringify(t)));return window.location.href.split("#").shift()+"#"+i},_logEvent:function(e,t){if(!1===this.options.log_events)return!1;m.ajax({type:"POST",url:this.options.ajax_url,data:{action:"useyourdrive-event-stats",type:e,id:t,_ajax_nonce:this.options.log_nonce}})},_actionPreviewEntry:function(e){m(".qtip").qtip("hide");var t=e.closest("ul").attr("data-id");this.element.find(".entry[data-id='"+t+"']").find(".entry_link")[0].click()},_actionDownloadEntry:function(e){sendDriveGooglePageView("Download",e.attr("data-filename"));var t=e.closest("ul").attr("data-id");void 0===t&&(t=e.closest(".entry").attr("data-id"));var i=m('<div><i class="fas fa-cog fa-spin fa-1x fa-fw"></i></div>').css({"margin-right":"5px",display:"inline-grid"}).delay(5e3).fadeOut("slow",function(){m(this).remove()});this.element.find(".layout-grid .entry[data-id='"+t+"'] .entry-name-view").prepend(i),this.element.find(".layout-list .entry[data-id='"+t+"'] .entry_name").prepend(i),setTimeout(function(){return m(".qtip").qtip("hide"),!0},300)},_actionExportEntry:function(e,t){e.stopPropagation();var i=t.attr("href");return sendDriveGooglePageView("Export",t.attr("data-filename")),setTimeout(function(){return m(".qtip").qtip("hide"),window.location=i,!0},300),!1},_actionShareEntry:function(e){var t=this;m(".qtip").qtip("hide");var i=e.closest("ul").attr("data-id"),o=t.element.find(".entry[data-id='"+i+"']").attr("data-name");if(e.hasClass("entry_action_shortlink_folder"))i=t.element.attr("data-id");m("#useyourdrive-modal-action").remove();var n="";n+='<button class="button useyourdrive-modal-confirm-btn" data-action="confirm" type="button" title="'+t.options.str_create_shared_link+'" >'+t.options.str_create_shared_link+"</button>",n+='<button class="button useyourdrive-modal-cancel-btn" data-action="cancel" type="button" onclick="modal_action.close();" title="'+t.options.str_close_title+'" >'+t.options.str_close_title+"</button>";var a=m('<a tabindex="0" class="close-button" title="'+t.options.str_close_title+'" onclick="modal_action.close();"><i class="fas fa-times fa-lg" aria-hidden="true"></i></a></div>'),s=m('<div class="useyourdrive-modal-body" tabindex="0" ></div>'),r=m('<div class="useyourdrive-modal-footer"><div class="useyourdrive-modal-buttons">'+n+"</div></div>"),l=m('<div id="useyourdrive-modal-action" class="UseyourDrive useyourdrive-modal '+t.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');m("body").append(l),m("#useyourdrive-modal-action .modal-content").append(a,s,r),m.ajax({type:"POST",url:t.options.ajax_url,data:{action:"useyourdrive-create-link",listtoken:t.options.listtoken,id:i,_ajax_nonce:t.options.createlink_nonce},complete:function(){m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").remove()},success:function(e){null!==e&&(null!==e.link?(m(".useyourdrive-modal-body").append('<input type="text" class="shared-link-url" value="'+e.link+'" style="width: 98%;" readonly/><div class="useyourdrive-shared-social"></div>'),sendDriveGooglePageView("Create shared link"),m.extend(jsSocials.shares,{directlink:{label:"Link",logo:"fas fa-link",shareIn:"blank",shareUrl:function(){return e.link},countUrl:""}}),m(".useyourdrive-shared-social").jsSocials({url:e.link,text:o+" | ",showLabel:!1,showCount:"inside",shareIn:"popup",shares:["email","twitter","facebook","googleplus","linkedin","pinterest","whatsapp"]})):m(".useyourdrive-modal-body").find(".shared-link-url").val(e.error))},dataType:"json"});var d=new RModal(document.getElementById("useyourdrive-modal-action"),{dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){d.keydown(e)},!1),d.open(),window.modal_action=d,m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").prop("disabled",!0),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").html('<i class="fas fa-cog fa-spin fa-fw"></i><span> '+t.options.str_processing+"</span>"),!1},_actionCreateEntry:function(e){var i=this;m(".qtip").qtip("hide"),m("#useyourdrive-modal-action").remove();var t="";t+='<button class="button useyourdrive-modal-confirm-btn" data-action="rename" type="button" title="'+i.options.str_addfolder_title+'" >'+i.options.str_addfolder_title+"</button>",t+='<button class="button useyourdrive-modal-cancel-btn" data-action="cancel" type="button" onclick="modal_action.close();" title="'+i.options.str_cancel_title+'" >'+i.options.str_cancel_title+"</button>";var o=m('<a tabindex="0" class="close-button" title="'+i.options.str_close_title+'" onclick="modal_action.close();"><i class="fas fa-times fa-lg" aria-hidden="true"></i></a></div>'),n=m('<div class="useyourdrive-modal-body" tabindex="0" >'+i.options.str_addfolder+' <br/><input type="text" id="useyourdrive-modal-addfolder-input" name="useyourdrive-modal-addfolder-input" value="" style="width:100%"/></div>'),a=m('<div class="useyourdrive-modal-footer"><div class="useyourdrive-modal-buttons">'+t+"</div></div>"),s=m('<div id="useyourdrive-modal-action" class="UseyourDrive useyourdrive-modal '+i.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');m("body").append(s),m("#useyourdrive-modal-action .modal-content").append(o,n,a),m("#useyourdrive-modal-action #useyourdrive-modal-addfolder-input").unbind("keyup"),m("#useyourdrive-modal-action #useyourdrive-modal-addfolder-input").on("keyup",function(e){13!=e.which&&13!=e.keyCode||m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").trigger("click")}),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").unbind("click"),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").click(function(){var e=m("#useyourdrive-modal-addfolder-input").val();if(/[<>:"/\\|?*]/g.test(m("#useyourdrive-modal-addfolder-input").val()))m("#useyourdrive-modal-action .useyourdrive-modal-error").remove(),m("#useyourdrive-modal-addfolder-input").after('<div class="useyourdrive-modal-error">'+i.options.str_rename_failed+"</div>"),m("#useyourdrive-modal-action .useyourdrive-modal-error").fadeIn();else{var t={action:"useyourdrive-add-folder",newfolder:encodeURIComponent(e),_ajax_nonce:i.options.addfolder_nonce};i._actionDoModifyEntry(t),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").prop("disabled",!0),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").html('<i class="fas fa-cog fa-spin fa-fw"></i><span> '+i.options.str_processing+"</span>")}});var r=new RModal(document.getElementById("useyourdrive-modal-action"),{dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){r.keydown(e)},!1),r.open(),window.modal_action=r,!1},_actionRenameEntry:function(e){var i=this;m(".qtip").qtip("hide");var o=e.closest("ul").attr("data-id"),t=i.element.find(".entry[data-id='"+o+"']").attr("data-name");m("#useyourdrive-modal-action").remove();var n="";n+='<button class="button useyourdrive-modal-confirm-btn" data-action="rename" type="button" title="'+i.options.str_rename_title+'" >'+i.options.str_rename_title+"</button>",n+='<button class="button useyourdrive-modal-cancel-btn" data-action="cancel" type="button" onclick="modal_action.close();" title="'+i.options.str_cancel_title+'" >'+i.options.str_cancel_title+"</button>";var a='<input id="useyourdrive-modal-rename-input" name="useyourdrive-modal-rename-input" type="text" value="'+t+'" style="width:100%"/>',s=m('<a tabindex="0" class="close-button" title="'+i.options.str_close_title+'" onclick="modal_action.close();"><i class="fas fa-times fa-lg" aria-hidden="true"></i></a></div>'),r=m('<div class="useyourdrive-modal-body" tabindex="0" >'+i.options.str_rename+"<br/>"+a+"</div>"),l=m('<div class="useyourdrive-modal-footer"><div class="useyourdrive-modal-buttons">'+n+"</div></div>"),d=m('<div id="useyourdrive-modal-action" class="UseyourDrive useyourdrive-modal '+i.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');m("body").append(d),m("#useyourdrive-modal-action .modal-content").append(s,r,l),m("#useyourdrive-modal-action #useyourdrive-modal-rename-input").unbind("keyup"),m("#useyourdrive-modal-action #useyourdrive-modal-rename-input").on("keyup",function(e){13!=e.which&&13!=e.keyCode||m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").trigger("click")}),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").unbind("click"),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").click(function(){var e=m("#useyourdrive-modal-rename-input").val();if(/[<>:"/\\|?*]/g.test(m("#useyourdrive-modal-rename-input").val()))m("#useyourdrive-modal-action .useyourdrive-modal-error").remove(),m("#useyourdrive-modal-rename-input").after('<div class="useyourdrive-modal-error">'+i.options.str_rename_failed+"</div>"),m("#useyourdrive-modal-action .useyourdrive-modal-error").fadeIn();else{var t={action:"useyourdrive-rename-entry",id:o,newname:encodeURIComponent(e),_ajax_nonce:i.options.rename_nonce};i._actionDoModifyEntry(t),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").prop("disabled",!0),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").html('<i class="fas fa-cog fa-spin fa-fw"></i><span> '+i.options.str_processing+"</span>")}});var u=new RModal(document.getElementById("useyourdrive-modal-action"),{dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){u.keydown(e)},!1),u.open(),window.modal_action=u,!1},_actionEditDescriptionEntry:function(e,o){var n=this,a=o.attr("data-id"),t=o.closest(".UseyourDrive").find(".description_text"),s=t.html(),r=m("<textarea />").addClass("description_textarea");r.val(s.replace(/<br\s?\/?>/g,"\n")),t.replaceWith(r);var l=m('<img src="'+n.options.plugin_url+'/css/images/wpspin_light-2x.gif" width="16" height="16" />').addClass("ajaxprocess").hide(),d=m('<input type="button" class="button" value="'+n.options.str_save_title+'"/>');return r.after(l).after(d),r.focus(),o.hide(),d.click(function(){var t=r.val(),i=m("<div>").addClass("description_text");m.ajax({type:"POST",url:n.options.ajax_url,data:{action:"useyourdrive-edit-description-entry",id:a,newdescription:encodeURIComponent(t),listtoken:n.options.listtoken,_ajax_nonce:n.options.description_nonce},beforeSend:function(){d.prop("disabled",!0).fadeTo(400,.3),l.show()},complete:function(){o.show(),d.remove(),l.remove()},error:function(){i.html(s),r.replaceWith(i)},success:function(e){if(null!==e&&void 0!==e.description)return t=e.description,i.html(t.replace(/\r\n|\r|\n/g,"<br />")),void r.replaceWith(i);i.html(s),r.replaceWith(i)},dataType:"json"})}),!1},_actionMoveEntry:function(e,t){var i={action:"useyourdrive-move-entry",id:e.attr("data-id"),copy:!1,target:t.attr("data-id"),_ajax_nonce:this.options.move_nonce};this._actionDoModifyEntry(i)},_actionDeleteEntries:function(e){m(".qtip").qtip("hide"),m("#useyourdrive-modal-action").remove();var t=this,o="",n=[];m.each(e,function(){var e=m(this).closest(".entry"),t=e.find("img:first()"),i=m('<div class="useyourdrive-modal-file-icon">');0<t.length&&t.clone().appendTo(i),o+="<li>"+i.html()+"<span>"+e.attr("data-name")+"</span></li>",n.push(m(this).val())});var i="";i+='<button class="button useyourdrive-modal-confirm-btn" data-action="confirm" type="button" title="'+t.options.str_delete_title+'" >'+t.options.str_delete_title+"</button>",i+='<button class="button useyourdrive-modal-cancel-btn" data-action="cancel" type="button" onclick="modal_action.close();" title="'+t.options.str_cancel_title+'" >'+t.options.str_cancel_title+"</button>";var a=m('<a tabindex="0" class="close-button" title="'+t.options.str_close_title+'" onclick="modal_action.close();"><i class="fas fa-times fa-lg" aria-hidden="true"></i></a></div>'),s=m('<div class="useyourdrive-modal-body" tabindex="0" >'+t.options.str_delete+'</br></br><ul class="files">'+o+"</ul></div>"),r=m('<div class="useyourdrive-modal-footer"><div class="useyourdrive-modal-buttons">'+i+"</div></div>"),l=m('<div id="useyourdrive-modal-action" class="UseyourDrive useyourdrive-modal '+t.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');m("body").append(l),m("#useyourdrive-modal-action .modal-content").append(a,s,r),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").unbind("click"),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").click(function(){var e={action:"useyourdrive-delete-entries",entries:n,_ajax_nonce:t.options.delete_nonce};t._actionDoModifyEntry(e),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").prop("disabled",!0),m("#useyourdrive-modal-action .useyourdrive-modal-confirm-btn").html('<i class="fas fa-cog fa-spin fa-fw"></i><span> '+t.options.str_processing+"</span>")});var d=new RModal(document.getElementById("useyourdrive-modal-action"),{dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){d.keydown(e)},!1),d.open(),window.modal_action=d,!1},_actionDoModifyEntry:function(e){var t=this,i=t.element.attr("data-id");e.listtoken=this.options.listtoken,e.lastFolder=i,m.ajax({type:"POST",url:t.options.ajax_url,data:e,beforeSend:function(){t.options.loadingContainer.fadeIn(400)},success:function(e){void 0!==e&&void 0!==e.lastFolder&&null!==e.lastFolder&&t.element.attr("data-id",e.lastFolder)},complete:function(){"undefined"!=typeof modal_action&&modal_action.close(),"undefined"!=typeof modal&&modal.close(),t.options.forceRefresh=!0,t._getFileList({})},dataType:"json"})},_uploadValidateFile:function(e,t){var i=this,o=i.element.find('input[name="maxfilesize"]').val(),n=new RegExp(i.element.find('input[name="acceptfiletypes"]').val(),"i");if(e.error=!1,e.name.length&&!n.test(e.name)&&(e.error=i.options.acceptFileTypes),""!==o&&0<e.size&&e.size>o&&(e.error=i.options.maxFileSize),0<i.number_of_uploaded_files.Max&&i.number_of_uploaded_files.Counter>i.number_of_uploaded_files.Max){var a=!0;m.each(i.uploaded_files_storage,function(){this.name===e.name&&(a=!1,i.number_of_uploaded_files.Counter--)}),a&&(e.error=i.options.maxNumberOfFiles)}return e},_uploadGetProgress:function(t){var i=this;m.ajax({type:"POST",url:i.options.ajax_url,data:{action:"useyourdrive-upload-file",type:"get-status",listtoken:i.options.listtoken,hash:t.hash,_ajax_nonce:i.options.upload_nonce},dataType:"json",success:function(e){null!==e&&(void 0!==e.status?("starting"!==e.status.progress&&"uploading"!==e.status.progress||setTimeout(function(){i._uploadGetProgress(e.file)},1500),i._uploadRenderRowOnProgress(e.file,{percentage:50+e.status.percentage/2,progress:e.status.progress})):(t.error=i.options.str_error,i._uploadRenderRowOnFinish(t)))},error:function(e){t.error=i.options.str_error,i._uploadRenderRowOnFinish(t)}})},_uploadRenderRow:function(e){var t=this,i=t.element.find(".template-row").clone().removeClass("template-row"),o=m('<a class="cancel-upload"><i class="fas fa-ban" aria-hidden="true"></i> '+t.options.str_delete_title+"</a>");return i.attr("data-file",e.name).attr("data-id",e.hash),i.find(".file-name").text(e.name),"undefined"!==e.size&&0<e.size&&i.find(".file-size").text(t._helperFormatBytes(e.size,1)),i.find(".upload-thumbnail img").attr("src",t._uploadGetThumbnail(e)),i.addClass("template-upload"),i.find(".upload-status").removeClass().addClass("upload-status queue").append(o),i.find(".upload-status-icon").removeClass().addClass("upload-status-icon fas fa-circle").hide(),t.element.find(".fileupload-list .files").append(i),t.element.find("div.fileupload-drag-drop").fadeOut(),void 0!==e.error&&!1!==e.error&&t._uploadRenderRowOnFinish(e),i},_uploadRenderRowOnStart:function(e){var t=this.element.find(".fileupload-list [data-id='"+e.hash+"']");t.find(".upload-status").removeClass().addClass("upload-status succes").text(this.options.str_uploading_local),t.find(".upload-status-icon").removeClass().addClass("upload-status-icon fas fa-circle-o-notch fa-spin").fadeIn(),t.find(".upload-progress").slideDown(),m('input[type="submit"]').prop("disabled",!0).fadeTo(400,.3)},_uploadRenderRowOnProgress:function(e,t){var i=this.element.find(".fileupload-list [data-id='"+e.hash+"']"),o=i.find(".ui-progressbar");o.find(".ui-progressbar-value").fadeIn().animate({width:t.percentage/100*o.width()},50),"uploading_to_cloud"===t.progress&&i.find(".upload-status").text(this.options.str_uploading_cloud)},_uploadRenderRowOnFinish:function(e){var t=this,i=t.element.find(".fileupload-list [data-id='"+e.hash+"']");i.addClass("template-download").removeClass("template-upload"),i.find(".file-name").text(e.name),i.find(".upload-thumbnail img").attr("src",t._uploadGetThumbnail(e)),i.find(".upload-progress").slideUp(),void 0!==e.error&&!1!==e.error?(i.find(".upload-status").removeClass().addClass("upload-status error").text(t.options.str_error),i.find(".upload-status-icon").removeClass().addClass("upload-status-icon fas fa-exclamation-circle"),i.find(".upload-error").text(e.error).slideUp().delay(500).slideDown(),t.number_of_uploaded_files.Counter--):(i.find(".upload-status").removeClass().addClass("upload-status succes").text(t.options.str_success),i.find(".upload-status-icon").removeClass().addClass("upload-status-icon fas fa-check-circle"),t.uploaded_files.push(e.fileid)),t.element.find(".template-upload").length<1&&(clearTimeout(t.uploadPostProcessTimer),t.uploadPostProcessTimer=setTimeout(function(){t._uploadDoPostProcess()},500)),0<i.closest(".gform_wrapper").length||0<i.closest(".wpcf7").length||!0===t.element.hasClass("upload")||t._uploadDeleteRow(e,5e3)},_uploadDeleteRow:function(e,t){var i=this;i.element.find(".fileupload-list [data-id='"+e.hash+"']").delay(t).animate({opacity:"0"},"slow",function(){m(this).remove(),i.element.find(".template-upload").length<1&&i.element.find("div.fileupload-drag-drop").fadeIn()})},_uploadDoRequest:function(e){var t=this;0===m.active?e.submit():window.setTimeout(function(){t._uploadDoRequest(e)},200)},_uploadDoConvert:function(t){var i=this;i.element.find(".fileupload-list [data-id='"+t.hash+"']");m.ajax({type:"POST",url:UseyourDrive_vars.ajax_url,data:{action:"useyourdrive-upload-file",type:"upload-convert",listtoken:i.options.listtoken,fileid:t.fileid,convert:t.convert,_ajax_nonce:i.options.upload_nonce},success:function(e){null!==e?void 0===e.result||0===e.result?t.error=i.options.str_error:t.fileid=e.fileid:t.error=i.options.str_error},error:function(e){t.error=i.options.str_error},complete:function(e){i._uploadRenderRowOnFinish(t)},dataType:"json"})},_uploadDoPostProcess:function(){var i=this;m.ajax({type:"POST",url:i.options.ajax_url,data:{action:"useyourdrive-upload-file",type:"upload-postprocess",listtoken:i.options.listtoken,files:i.uploaded_files,_ajax_nonce:i.options.upload_nonce},success:function(e){null!==e&&(i.uploaded_files=[],m.each(e.files,function(e,t){i.uploaded_files_storage[e]={hash:e,name:t.name,type:t.type,path:t.completepath,size:t.filesize,link:t.link,folderurl:t.folderurl}}),i.element.closest("form").find(".fileupload-filelist").val(JSON.stringify(i.uploaded_files_storage)))},complete:function(e){!1===i.element.hasClass("upload")&&(i.options.clearLocalCache=!0,clearTimeout(i.updateTimer),i._getFileList({})),i.element.find(".fileupload-filelist").find(".template-upload").length<1&&(window.onbeforeunload=null,i.element.find(".fileuploadform").trigger("useyourdrive-upload-finished"))},dataType:"json"})},_uploadGetThumbnail:function(e){var t=this.options.icons_set;return void 0===e.thumbnail||null===e.thumbnail||""===e.thumbnail?t+(void 0===e.type||null===e.type?"icon_11_generic_xl128":0<=e.type.indexOf("word")?"icon_11_word_xl128":0<=e.type.indexOf("excel")||0<=e.type.indexOf("spreadsheet")?"icon_11_excel_xl128":0<=e.type.indexOf("powerpoint")||0<=e.type.indexOf("presentation")?"icon_11_powerpoint_xl128":0<=e.type.indexOf("image")?"icon_11_image_xl128":0<=e.type.indexOf("audio")?"icon_11_audio_xl128":0<=e.type.indexOf("video")?"icon_11_video_xl128":0<=e.type.indexOf("pdf")?"icon_11_pdf_xl128":0<=e.type.indexOf("text")?"icon_11_text_xl128":"icon_11_generic_xl128")+".png":e.thumbnail},_initDragDrop:function(){var a=this;m(document).bind("dragover",function(e){var t=a.element,i=window.dropZoneTimeout;i?clearTimeout(i):t.addClass("in");var o=!1,n=e.target;do{if(m(n).is(t)){o=!0;break}n=n.parentNode}while(null!==n);o?m(n).addClass("hover"):t.removeClass("hover"),window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null,t.removeClass("in hover")},100)}),m(document).bind("drop dragover",function(e){e.preventDefault()})},_initResizeHandler:function(){var e=this;e._orgininal_width=e.element.width(),m(window).resize(function(){e._orgininal_width!==e.element.width()&&(e._orgininal_width=e.element.width(),e._refreshView())})},_refreshView:function(){var e=this;e.element.find(".jp-jplayer").each(function(){if(void 0!==m(this).data().jPlayer){var e=m(this).data().jPlayer.status;if(0!==e.videoHeight&&0!==e.videoWidth){var t=e.videoWidth/e.videoHeight,i=m(this);if(0<m(this).find("object").length)var o=m(this).find("object");else o=m(this).find("video");i.height()!==i.width()/t&&(screen.height>=i.width()/t||"jp-video-full"!==e.cssClass?(o.height(o.width()/t),i.height(o.width()/t)):(o.width(screen.height*t),i.width(screen.height*t))),m(this).parent().find(".jp-video-play").height(i.height())}}}),void 0!==e.resizeTimer&&clearTimeout(e.resizeTimer),e.element.find(".image-collage").fadeTo(100,0),e.element.find(".layout-grid").fadeTo(100,0),e.resizeTimer=setTimeout(function(){(e.options.topContainer.hasClass("files")||e.options.topContainer.hasClass("search"))&&e.renderContentForBrowser(),e.options.topContainer.hasClass("gallery")&&e.renderContentForGallery()},100)},_pipeline:function(e){var s=this,r=m.extend({url:s.options.ajax_url,data:null,method:"POST"},e);return function(t,i,o){var e=r.data(t);m.extend(t,e);var n="CloudPlugin_"+(t.listtoken+t._ajax_nonce+t.filelayout+(void 0===t.id?t.lastFolder:t.id)+t.sort+t.query).hashCode();if(s.options.clearLocalCache&&(s._cacheRemove("all"),s.options.clearLocalCache=!1),s.options.forceRefresh&&(s._cacheRemove("all"),t.hardrefresh=!0,s.options.forceRefresh=!1),null!==s._cacheGet(n)){var a=s._cacheGet(n);return a.draw=t.draw,i(s,a),!0}void 0!==o.jqXHR&&null!==o.jqXHR&&o.jqXHR.abort(),o.jqXHR=m.ajax({type:r.method,url:r.url,data:t,dataType:"json",cache:!1,beforeSend:function(){},success:function(e){if(null===e&&0===e)return s.element.trigger("ajax-error",[e,t,o.jqXHR]),i(s,!1),!1;s.element.trigger("ajax-success",[e,t,o.jqXHR]),s._cacheSet(n,e),i(s,e)},error:function(e){return s.element.trigger("ajax-error",[e,t,o.jqXHR]),i(s,!1),!1}})}},_initCache:function(){var e=this;e._isCacheStorageAvailable=e._cacheStorageAvailable(),setInterval(function(){e._cacheRemove("all")},9e5)},_cacheStorageAvailable:function(){try{var t=window.sessionStorage,e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==t.length}},_cacheGet:function(e){if(void 0===this.cache.expires){var t=new Date;t.setMinutes(t.getMinutes()+15),this.cache.expires=t}return this.cache.expires.getTime()<(new Date).getTime()&&this._cacheRemove(e),this._isCacheStorageAvailable?JSON.parse(sessionStorage.getItem(e)):void 0===this.cache[e]?null:this.cache[e]},_cacheSet:function(e,t){if(this._isCacheStorageAvailable)try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){return this._cacheRemove("all"),!1}else void 0===this.cache[e]&&(this.cache[e]={}),this.cache[e]=t},_cacheRemove:function(e){if(this._isCacheStorageAvailable)if("all"===e)for(var t=sessionStorage.length;t--;){e=sessionStorage.key(t);/CloudPlugin/.test(e)&&sessionStorage.removeItem(e)}else sessionStorage.removeItem(e);else"all"===e?delete this.cache:delete this.cache[e]},_helperDownloadUrlInline:function(e){var t="hiddenDownloader",i=document.getElementById(t);null===i&&((i=document.createElement("iframe")).id=t,i.style.display="none",document.body.appendChild(i)),i.src=e},_helperFormatBytes:function(e,t){if(0==e)return"";var i=t+1||3,o=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,o)).toFixed(i))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]},_helperIframeFix:function(e){/iPhone|iPod|iPad/.test(navigator.userAgent)&&e.each(function(){0===m(this).closest("#safari_fix").length&&m(this).wrap(function(){return m('<div id="safari_fix"/>').css({width:"100%",height:"100%",overflow:"auto","z-index":"2","-webkit-overflow-scrolling":"touch"})})})},_helperCachedScript:function(e,t){return t=jQuery.extend(t||{},{dataType:"script",cache:!0,url:e}),jQuery.ajax(t)},_helperReadArrCheckBoxes:function(e){return m(e+":checked").map(function(){return this.value}).get()},_helperIsIE:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&parseInt(e.split("msie")[1])}})}(jQuery),jQuery(".UseyourDrive").UseyourDrive(UseyourDrive_vars);var uyd_playlists={};function sendDriveGooglePageView(e,t){"1"===UseyourDrive_vars.google_analytics&&("undefined"!=typeof ga&&null!==ga&&ga("send","event","Use-your-Drive",e,t),"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Use-your-Drive",e,t]),"undefined"!=typeof gtag&&null!==gtag&&gtag("event",e,{event_category:"Use-your-Drive",event_label:t,value:t}))}